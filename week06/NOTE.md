## 有限状态机

- Moore 每个机器都有确定的下一个状态
- [Mearly]() 每一个机器根据输入决定下一个状态

> mealy中, 每个函数都是一个状态, 每个状态处理各自逻辑互不干扰, 通过返回下一个状态进行"通信"


## HTML解析

<b>URL</b> -> <b>HTML</b> - > <b>DOM</b> -> DOM with css -> DOM with position


1. http解析, 接收html文本
2. 运用状态机,对html进行解析
  1. 解析标签(开始标签,接收标签,自封闭标签...)
  2. 处理属性 (单引号,双引号,无引号)
  3. 构建DOM树,遇到开始标签创建元素入栈,遇到结束标签出栈,自封闭节点入栈后立刻出栈

  4. 先收集css rules
  5. CSSComputed, 每创建一个元素,立刻计算CSS
  6. 获取当前元素的父元素,进行规则判断,css计算顺序是从内到外
  7. 拆分选择器, 复杂选择器拆成针对单个元素的选择器,用循环匹配父元素队列
  8. 计算选择器与元素匹配 (id, class, 标签 三种选择器)
  9. 生成computed属性,一旦匹配,就应用到选择器的元素上,形成computedStyle
  10. 规则覆盖,css规则根据specificity和后来优先规则覆盖,specificity是个四元组,越左权重越高
  11. 布局计算, ....待续